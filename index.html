<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      shemerey.com &middot; My Blog about tech, Web & Mobile development. IoT etc.
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
<link rel="apple-touch-icon" sizes="57x57" href="/public/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/public/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/public/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/public/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/public/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/public/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/public/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/public/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/public/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/public/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/public/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/public/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/public/favicon-16x16.png">
<link rel="manifest" href="/public/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/public/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="sh-theme">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p></p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About Me</a>
        
      
    
      
    
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2016. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">shemerey.com</a>
            <small>My Blog about tech, Web & Mobile development. IoT etc.</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/05/10/fix-for-setting-locale-failed/">
        Fix for 'SETTING LOCALE FAILED'
      </a>
    </h1>

    <span class="post-date">10 May 2016</span>

    <p>I was recently experience some annoying thing. If you choose to install <code class="highlighter-rouge">dokku</code>
on <code class="highlighter-rouge">DigitalOcean</code> you will probably get something like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE <span class="o">=</span> <span class="o">(</span><span class="nb">unset</span><span class="o">)</span>,
	LC_ALL <span class="o">=</span> <span class="o">(</span><span class="nb">unset</span><span class="o">)</span>,
	LC_CTYPE <span class="o">=</span> <span class="s2">"UTF-8"</span>,
	LANG <span class="o">=</span> <span class="s2">"en_US.UTF-8"</span>
    are supported and installed on your system.
perl: warning: Falling back to the standard locale <span class="o">(</span><span class="s2">"C"</span><span class="o">)</span>.
</code></pre>
</div>

<p>It catching eye and drives me nuts. Following instruction can save you some time
if you have the same.</p>

<p>You just need update your <code class="highlighter-rouge">locale</code> file</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo <span class="nb">echo</span>  <span class="s2">"LANGUAGE=en_US.UTF-8 </span><span class="se">\n</span><span class="s2">LC_ALL=en_US.UTF-8 </span><span class="se">\n</span><span class="s2">LANG=en_US.UTF-8 </span><span class="se">\n</span><span class="s2">LC_TYPE=en_US.UTF-8"</span> &gt;&gt; /etc/default/locale
</code></pre>
</div>

<p>and reconfigure it</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo locale-gen en_US.UTF-8
<span class="gp">$ </span>sudo dpkg-reconfigure locales
</code></pre>
</div>

<p>As result you gonna see something like this</p>

<div class="highlighter-rouge"><pre class="highlight"><code>dpkg-reconfigure locales
Generating locales...
  en_AG.UTF-8... <span class="k">done
  </span>en_AU.UTF-8... <span class="k">done
  </span>en_BW.UTF-8... <span class="k">done
  </span>en_CA.UTF-8... <span class="k">done
  </span>en_DK.UTF-8... <span class="k">done
  </span>en_GB.UTF-8... <span class="k">done</span>
  ....
</code></pre>
</div>

<p>Don’t forget to reconnect, this changes will have effect with new session.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/05/09/cron-tips-tricks/">
        Cron tips & tricks
      </a>
    </h1>

    <span class="post-date">09 May 2016</span>

    <p>CronTab is pretty powerful app, but we often don’t pay attention to it, here is some tips i’ve found useful for me.</p>

<h3 id="format">Format</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">*</span>    <span class="k">*</span>    <span class="k">*</span>    <span class="k">*</span>    <span class="k">*</span>  <span class="nb">command </span>to be executed
┬    ┬    ┬    ┬    ┬
│    │    │    │    │
│    │    │    │    │
│    │    │    │    └───── day of week <span class="o">(</span>0 - 6<span class="o">)</span>
│    │    │    └────────── month <span class="o">(</span>1 - 12<span class="o">)</span>
│    │    └─────────────── day of month <span class="o">(</span>1 - 31<span class="o">)</span>
│    └──────────────────── hour <span class="o">(</span>0 - 23<span class="o">)</span>
└───────────────────────── min <span class="o">(</span>0 - 59<span class="o">)</span>
</code></pre>
</div>

<h3 id="some-examples">Some Examples</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>0 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span>     every hour
<span class="k">*</span>/15 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span>  every 15 mins
0 <span class="k">*</span>/2 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span>   every 2 hours
0 0 0 <span class="k">*</span> 0     every sunday midnight
</code></pre>
</div>

<h3 id="basic-commands">Basic commands</h3>

<p>Open in editor
<code class="highlighter-rouge">bash
$ crontab -e
</code></p>

<p>List tasks
<code class="highlighter-rouge">bash
crontab -l [-u user]
</code></p>

<h3 id="cron-tab-checkers">Cron Tab checkers</h3>

<p>It’s hard to remember this format, and crontab doesn’t provide a handy way to check your syntax, like <code class="highlighter-rouge">nginx</code> does for instance. But there is plenty of checkers online what you can use.</p>

<ul>
  <li><a href="http://crontab.guru/">http://crontab.guru/</a></li>
  <li><a href="http://cron.schlitt.info/">http://cron.schlitt.info/</a></li>
  <li><a href="http://crontab-generator.org/">http://crontab-generator.org/</a></li>
</ul>

<h3 id="apply-the-principle-of-least-privilege">Apply the principle of least privilege</h3>

<p>The sixth column of a system crontab(5) file is the username of the user as which the task should run:</p>

<pre><code class="language-crontab">0 * * * *  root  cron-task
</code></pre>

<p>To the extent that is practical, you should run the task as a user with only the privileges it needs to run, and nothing else. This can sometimes make it worthwhile to create a dedicated system user purely for running scheduled tasks relevant to your application.</p>

<pre><code class="language-crontab">0 * * * *  myappcron  cron-task
</code></pre>

<p>This is not just for security reasons, although those are good ones; Similarly, for tasks with database systems such as <code class="highlighter-rouge">MySQL</code>, don’t use the administrative root user if you can avoid it; instead, use or even create a dedicated user with a unique random password stored in a locked-down <code class="highlighter-rouge">~/.my.cnf</code> file, with only the needed permissions. For a <code class="highlighter-rouge">MySQL</code> backup task, for example, only a few permissions should be required, including <code class="highlighter-rouge">SELECT</code>, <code class="highlighter-rouge">SHOW VIEW</code>, and <code class="highlighter-rouge">LOCK TABLES</code>.</p>

<h3 id="customize-your-tasks-properly">Customize your tasks properly</h3>

<p>If necessary, you can set arbitrary environment variables for the tasks at the top of the file:</p>

<pre><code class="language-crontab">MYVAR=myvalue

0 * * * *  you  cron-task-which-use-env-vars
</code></pre>

<h3 id="send-the-output-somewhere-useful">Send the output somewhere useful</h3>

<p>Another common mistake is failing to set a useful MAILTO at the top of the crontab(5) file, as the specified destination for any output and errors from the tasks. cron(8) uses the system mail implementation to send its messages, and typically, default configurations for mail agents will simply send the message to an mbox file in <code class="highlighter-rouge">/var/mail/$USER</code>, that they may not ever read. This defeats much of the point of mailing output and errors.</p>

<p>This is easily dealt with, though; ensure that you can send a message to an address you actually do check from the server, perhaps using mail(1):</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">printf</span> <span class="s1">'%s\n'</span> <span class="s1">'Test message'</span> | mail -s <span class="s1">'Test subject'</span> you@example.com
</code></pre>
</div>

<p>Once you’ve verified that your mail agent is correctly configured and that the mail arrives in your inbox, set the address in a <code class="highlighter-rouge">MAILTO</code> variable at the top of your file:</p>

<pre><code class="language-crontab">MAILTO=you@example.com

0 * * * *    you  cron-task-1
*/5 * * * *  you  cron-task-2
</code></pre>

<p>If you don’t want to use email for routine output, another method that works is sending the output to syslog with a tool like logger(1):</p>

<pre><code class="language-crontab">0 * * * *   you  cron-task | logger -it cron-task
</code></pre>

<p>Alternatively, you can configure aliases on your system to forward system mail destined for you on to an address you check. For Postfix, you’d use an aliases(5) file.</p>

<p>I sometimes use this setup in cases where the task is expected to emit a few lines of output which might be useful for later review, but send stderr output via <code class="highlighter-rouge">MAILTO</code> as normal. If you’d rather not use syslog, perhaps because the output is high in volume and/or frequency, you can always set up a log file <code class="highlighter-rouge">/var/log/cron-task.log</code> … but don’t forget to add a <code class="highlighter-rouge">logrotate</code> for it!</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2016/05/03/named-arguments-vs-indexed/">
        Named arguments vs Indexed
      </a>
    </h1>

    <span class="post-date">03 May 2016</span>

    <p>There is two ways of using arguments both has pros and cons, I want to emphasize
that there is no “silver bluet” and you don’t have to choose one or another.  You
have to know both and use both whenever it appropriate.</p>

<h2 id="indexed-arguments">Indexed arguments</h2>

<p>Some application, languages, and even syntax contractions force you to use index
version of arguments, they all well known and don’t worth to mention, but what
is really interesting that some times we can use it in unexpected places.</p>

<h3 id="in-postgres">in Postgres</h3>

<p>Each of the arguments you specify in a <code class="highlighter-rouge">select</code> has a 1-based index and you can
use these indexes in the <code class="highlighter-rouge">order by</code> as well as <code class="highlighter-rouge">group by</code> statements.</p>

<p>Instead of writing</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">select</span> <span class="n">id</span><span class="p">,</span> <span class="n">updated_at</span> <span class="k">from</span> <span class="n">posts</span> <span class="k">order</span> <span class="k">by</span> <span class="n">updated_at</span><span class="p">;</span>
</code></pre>
</div>

<p>you can write</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">select</span> <span class="n">id</span><span class="p">,</span> <span class="n">updated_at</span> <span class="k">from</span> <span class="n">posts</span> <span class="k">order</span> <span class="k">by</span> <span class="mi">2</span><span class="p">;</span>
</code></pre>
</div>

<p>If you want to group by a table’s <code class="highlighter-rouge">type</code> and then order by the counts from
highest to lowest, you can do the following</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">select</span> <span class="k">type</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="n">transaction</span> <span class="k">group</span> <span class="k">by</span> <span class="mi">1</span> <span class="k">order</span> <span class="k">by</span> <span class="mi">2</span> <span class="k">desc</span><span class="p">;</span>
</code></pre>
</div>

<h3 id="in-swift">in Swift</h3>

<p>Closure automatically provides shorthand argument names to inline closures,
which can be used to refer to the values of the arguments by the names $0, $1,
$2, and so on.</p>

<p>Instead of writing</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">reversed</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="nf">sort</span><span class="p">({</span>
    <span class="p">(</span><span class="nv">s1</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">s2</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">s1</span> <span class="o">&gt;</span> <span class="n">s2</span>
  <span class="p">})</span>
</code></pre>
</div>

<p>you can write</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">reversed</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="nf">sort</span><span class="p">(</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">&gt;</span> <span class="nv">$1</span> <span class="p">}</span> <span class="p">)</span>
</code></pre>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/04/25/git-stash/">
        $ git stash // for daily usage.
      </a>
    </h1>

    <span class="post-date">25 Apr 2015</span>

    <div class="message">
 One of the most awesome features in git is underestimated. <code>git stash</code> is awesome and you will see why.
</div>

<p>Imagine you average day, tons of task, issues, and concerns.
You have to switch on and off all the time during the day. It’s a bit annoying isn’t it ?</p>

<p>You spend some time to figure out what’s going on on a project, add some log statements, and <code class="highlighter-rouge">binding.pry</code>.
Your <code class="highlighter-rouge">console.log</code> is logging pretty much all information what you need, but manager want’s you to take a look on a urgent hotfix.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>git stash
</code></pre>
</div>

<p>Is going to help you, it works fine, but there is even more useful options. Use <code class="highlighter-rouge">-u</code> if you want to stash unstated files too.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>git stash -u
</code></pre>
</div>

<p>This command is going to clean you project tree to original state and keep all changes as well as new files in safe place.
Of course  you can restor it any time by hitting <code class="highlighter-rouge">git stash apply</code>, but if know for sure it was an experiment or just one time job, it’s better to use <code class="highlighter-rouge">git stash pop</code>,  pop work as expected and no more work for clean up you stashes required.</p>

<p>Last but not least things to know, you can use an awesome flag <code class="highlighter-rouge">-p</code> with stashes as you do with <code class="highlighter-rouge">git commit</code>. It works the same, you gonna be asked about any change in the same way.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>git stash -p
</code></pre>
</div>

  </div>
  
</div>



      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-9020230-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
